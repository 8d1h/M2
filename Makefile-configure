# -*- Mode: Makefile -*-

CONFIGURE_OPTIONS = --prefix=/tmp/Macaulay2

## to build:
##	edit the CONFIGURE_OPTIONS line above
##	make -f Makefile-configure
##	make
##      make install
## or
##      ./configure --prefix=/usr/local ...
##      make 
##      make install

## to rebuild configure script without using this makefile:
##	autoconf
##	autoheader

default : stage2

stage1 : configure include/config.h.in
aclocal.m4 : configure.in
	aclocal
#	touch $@
configure : configure.in aclocal.m4
	autoconf
include/config.h.in : configure.in
	autoheader
#	touch $@

stage2 : Makefile config.h
config.status : configure Makefile-configure
	./configure $(CONFIGURE_OPTIONS) --no-create
CONFIGURED_FILES := config.Makefile Makefile include/config.h
$(CONFIGURED_FILES) : $(CONFIGURED_FILES:=.in) config.status
	./config.status
#	touch include/config.h

TARGETS = all install dist check clean distclean uninstall

$(TARGETS) :: Makefile config.h
	make $@

