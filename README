				 Macaulay 2
		by Daniel R. Grayson and Michael E. Stillman

Macaulay 2 preliminary porting instructions and notes

    We use gcc/g++ version 2.95.2, gnu make version 3.79.1, and gawk 3.0.3;
you should install these yourself.  Be sure to install the latest version.
We use various other libraries, whose sources are included in this
distribution for your convenience, although you may prefer to pick up more
recent versions of these libraries.  These libraries have their own copying
licenses, as described below.  The copying license for Macaulay 2 is in
./Macaulay2/licenses/README.

library: Macaulay2
 author: Daniel R. Grayson <dan@math.uiuc.edu>
	 Michael E. Stillman <mike@math.cornell.edu>
 get at: http://www.math.uiuc.edu/Macaulay2
license: Macaulay2/licenses/README

library: factory
release: factory-1.2c
 author: G-M. Greuel <greuel@mathematik.uni-kl.de>
	 R. Stobbe <stobbe@mathematik.uni-kl.de>
 get at: helios.mathematik.uni-kl.de:/pub/Math/Factory
license: Macaulay2/licenses/factory.lic

library: libfac
release: libfac-0.3.0
 author: Michael Messollen <michael@math.uni-sb.de>
 get at:
license: libfac/00README

library: MP
release: 1.1.3
 author: S. Gray, N. Kajler, P. Wang 
 get at: ftp.mcs.kent.edu:dist/MP
license: mp/README

library: gmp
release: gmp-3.1.1
 author: Torbjorn Granlund <tege@nada.kth.se>
bugs to: <bug-gmp@prep.ai.mit.edu>
 get at: ftp.gnu.org:gnu/gmp
license: gmp/COPYING.LIB

library: gc
release: 6.0 alpha 2 (see file gc/version.h)
 author: Hans Boehm <hboehm@exch.hpl.hp.com>
 get at: http://www.hpl.hp.com/personal/Hans_Boehm/gc/gc_source/gc.tar.gz
license: gc/README

library: libm.so and libc.so from glibc
release: 2.2.1
 get at: ftp.gnu.org:gnu/glibc
license: Macaulay2/licenses/gnulib.lic

To configure Macaulay 2 type 'make -f Makefile-configure' in this directory,
or run 'configure' yourself.  If 'configure' isn't there, run 'autoheader; autoconf'
first.  See what options are available with 'configure --help'.

Recommended options to configure:

	--without-dumpdata		for Solaris and Microsoft Windows

To compile Macaulay 2 type 'make' in this directory.  The resulting shell
script, ./Macaulay2/bin/M2, can then be installed in /usr/local/bin.  The
resulting distributions/Macaulay2-*-tar.gz file can be distributed.
	
-----------------------
Windows 95, 98 and NT notes
-----------------------

There are two ways to compile Macaulay 2 under Windows 95 and NT.

	-------------------------------
	Microsoft Visual C/C++ compiler
	-------------------------------

	We use Microsoft Visual C/C++ compiler version 5.0 with service pack
	2.  First install the "gnuish" utilities in C:\WINNT\SYSTEM32:
	awk.exe, cp.exe, gawk.exe, grep.exe, ls.exe, make.exe, mv.exe,
	pwd.exe, rm.exe, sed.exe, and uname.exe.  Then open up the workspace,
	M2.dsw, set it to build the Release version, and start it compiling.

	To set the PATH environment variable used by the Developer Studio
	for custom build steps, edit the registry entry:
		My Computer\HKEY_CURRENT_USER\Software\Microsoft\DevStudio
			\5.0\Build System\Components\Platforms\Win32 (x86)
			\Directories\Path Dirs

	----------------------
	The Cygnus port of GCC
	----------------------

	Download cdk.exe from http://www.cygnus.com/misc/gnu-win32/ and
	type make.  It should all work!  (oops, does this require
	distribution of a .dll file, too?)

	You will also want to pick up emacs for Windows from
	http://www.cs.washington.edu/homes/voelker/ntemacs.html .

	Problems:
	   general:
		environment variables are all upper case!
		read() isn't interruptable
	   make:
		'export' does not work in makefiles.
		some targets in makefiles get run in parallel (?)
	   c library:
		abort() seems to be equivalent to exit(0)
	   bash:
		'cd ..' doesn't work from the initial directory
		when bash is started by emacs
	   ps:
		reports WIN32-PID in octal instead of decimal
	   kill:
		doesn't ever kill any processes

----------------------
Linux notes
----------------------

----------------------
HPUX notes
----------------------

On hppa-2.0w systems, gmp will not compile with gcc, so the configure script
for gmp prefers to use /usr/ccs/bin/cc.  So it is best to install gmp
separately, making sure /usr/ccs/bin is before /usr/local/bin on the path
(just in case gnu nm is in /usr/local/bin).  To use the previously installed
version of gmp when compiling M2, specify the option --with-gmp to configure,
or in Makefile.overrides.

Why don't we simply unset CC when automatically configuring gmp?  Because
under other operating systems, it is desirable for the same compiler to be
used for the whole package.  For example, under Windows, gcc and cl aren't
library compatible.

Another strange problem: the . command in /bin/sh seems to look along the
path instead in the current directory to find the file.  This causes a
problem for 'configure'.  Just edit its first line to use 'bash' instead.

----------------------
FreeBSD notes
----------------------

The gmp package didn't compile, but luckily I was able to use
the installed libgmp.a instead.  I did this:

	cd lib
	ln -s /usr/lib/libgmp.a libgmp.a

and commented out the Makefile line

	all:: GMP

Dumpdata doesn't work, so configure with the option --disable-dumpdata.

----------------------
MS-DOS notes
----------------------

The MS-DOS version is no longer supported, but here are the instructions
previously given.

Install DJGPP v2, available from /ftp@ftp.coast.net:SimTel/vendors/djgpp.
Install all the applications, too: make, ranlib, gawk, ar, sed, ...

Remember to use utod to convert all the *.m2 files in m2, m2/scriptde, and
tutorial/final to the msdos newline conventions.  This will ensure that
embedded strings containing newlines will have the right newline characters
there.

crt0.s: The source is in djlsr201.zip, and needs to be modified according to
	the file Macaulay2/msdos/crt0-diffs to support gc.  Do this manually
	and replace %DJGPP%/lib/crt0.o.
	The variable _go32_info_block is defined in src/libc/go32/infostrc.c.
gmp: Use the file make.bat that comes with it to compile it.
gc: Still needs a bit of work.
factory: Run 
		GMP_INCLUDE_PATH=../include
		export GMP_INCLUDE_PATH
		configure msdos --prefix=../lib --with-memman --with-optimize
	under Linux and then move Makefile and conf.h over.
libfac: The include files factor.h and Factor.h tend to get confused for each
	other.  One thing to try is to remove -I. from IFLAGS in libfac-0.2/Makefile.

-----------------------------------------------------------------------------

Macaulay 2 is copyright 1993-2001 by Daniel R. Grayson and Michael
E. Stillman, all rights reserved.

Daniel R. Grayson 	<dan@math.uiuc.edu>
Michael E. Stillman	<mike@math.cornell.edu>

-----------------------------------------------------------------------------
