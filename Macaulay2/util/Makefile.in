# @configure_input@
include ../../include/config.Makefile
VPATH = @srcdir@
EXES := echoout timestmp restart update
CFLAGS += -I. -I../../include -I../../libraries/final@FINALPREFIX@/$(librariesRelDir)/include
LDFLAGS += -L../../libraries/final@FINALPREFIX@/$(librariesRelDir)/lib
LD_LIBRARY_PATH := ../../libraries/final@FINALPREFIX@/$(librariesRelDir)/lib:$(LD_LIBRARY_PATH)
export LD_LIBRARY_PATH

ifeq ($(OS),Linux)
EXES += screen
endif

.PHONY : all clean distclean

all:: $(EXES)

# overlay.h is no longer needed
#  all:: overlay.h
#  overlay.h : overlay ; ./$< >$@

# all :: targettypes.h
#  we don't need targettypes.h any more
#  it's replaced by stdint.h
#  and it makes cross-compiling not work
# targettypes.h : targettypes ; ./$^ >$@

clean ::; rm -f overlay.h overlay gmon.out
update.o : restart.h
clean ::; rm -f $(EXES) *.o $(EXES:=.exe) $(EXES:=.obj) targettypes.h
../bin/linkexec : linkexec ; cp -a $< $@

ifeq "$(OS)" "Windows-95-98-NT"
all:: ../setup.exe
../setup.exe : setup
	cp setup.exe ..
endif

distclean : clean
	rm -f Makefile

Makefile : Makefile.in; cd ../..; ./config.status Macaulay2/util/Makefile

# gc_test
CPPFLAGS += -I@srcdir@/../../include
all :: gc_tested
gc_tested: gc_test; ./$<; touch $@
clean ::; rm -f gc_tested gc_test

# Local Variables:
# compile-command: "make -C $M2BUILDDIR/Macaulay2/util "
# End:
