# @configure_input@
include ../../include/config.Makefile
VPATH = @srcdir@
EXES := echoout timestmp restart update targettypes

CFLAGS += -I.

ifeq ($(OS),Linux)
EXES += screen
endif

.PHONY : all clean distclean

all:: $(EXES) targettypes.h overlay.h
targettypes.h : targettypes ; ./$^ >$@
overlay.h : overlay targettypes.h ; ./$< >$@
clean ::; rm -f overlay.h overlay gmon.out
update.o : restart.h
clean ::; rm -f $(EXES) *.o $(EXES:=.exe) $(EXES:=.obj) targettypes.h
../bin/linkexec : linkexec ; cp -a $< $@

ifeq "$(OS)" "Windows-95-98-NT"
all:: ../setup.exe
../setup.exe : setup
	cp setup.exe ..
endif

distclean : clean
	rm -f Makefile

Makefile : Makefile.in; cd ../..; ./config.status Macaulay2/util/Makefile

# gc_test
CPPFLAGS += -I@srcdir@/../../include
all :: gc_tested
gc_test : gc_test.c ; $(LINK.c) $^ $(GCLIB) -o $@
gc_tested: gc_test; ./$<; touch $@
clean ::; rm -f gc_tested gc_test

# Local Variables:
# compile-command: "make -C $M2BUILDDIR/Macaulay2/util "
# End:
