.SUFFIXES : .m2 .okay
EXE = ..\bin\Macaulay2.exe
.m2.okay:
	@echo testing $(EXE) on $*.m2
	@$(EXE) -silent setpath ../m2/setup.m2 $*.m2 -eexit(0)
	@echo okay > $@

!ifdef HAVE_FILES
!include files.tmp
tests: $(FILES:.m2=.okay)
$(FILES:.m2=.okay) : $(EXE)
!endif


all: version.m2 files.tmp
	@$(MAKE) -k -f Makefile.NT HAVE_FILES=1 -nologo tests

version.m2 : ..\m2\version.m2
	copy ..\m2\version.m2 version.m2

files.tmp : *.m2
	echo FILES = $** > files.tmp
