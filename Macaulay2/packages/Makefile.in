# @configure_input@
PACKAGES = minimal.m2 FirstPackage.m2 CacheFileName.m2 Dmodules.m2
include ../../include/config.Makefile
VPATH = @srcdir@
srcdir = $(shell cd @srcdir@; pwd)
DOC=cache/doc
TEST=cache/tests
.PHONY : all check initialize clean distclean install
DOCFILES := eliminate.m2 D-modules/DMODdoc.m2
clean check distclean ::; $(MAKE) -C ComputationsBook $@
Makefile: Makefile.in; cd ../..; ./config.status Macaulay2/packages/Makefile
distclean::clean
distclean::; rm -f Makefile

all :: $(PACKAGES:.m2=.installed)

%.installed : %.m2
	M2 -q --stop -e errorDepth=0 -e "installPackage(\"$*\", Encapsulate => false, PackagePrefix => \"./tmp-packages/\")" -e "exit 0"
	touch "$@"

clean::; rm -rf tmp tmp-packages *.installed
install: all; tar cf - -C tmp-packages . | tar xfpv - -C $(encapdir)

# ./tmp is used by examples in CacheFileName.m2
CacheFileName.installed : tmp
tmp : ; mkdir tmp

# Local Variables:
# compile-command: "make -C $M2BUILDDIR/Macaulay2/packages "
# End:
