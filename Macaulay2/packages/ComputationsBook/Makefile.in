# @configure_input@
include ../../../include/config.Makefile
VPATH = @srcdir@
CHAPTERS = completeIntersections \
	   constructions \
	   d-modules \
	   exterior-algebra \
	   geometry \
	   monomialIdeals \
	   preface \
	   programming \
	   schemes \
	   solving \
	   toricHilbertScheme \
	   varieties

.PHONY: clean changes distclean all check

ifneq "@srcdir@" "."
check :: $(CHAPTERS)
$(CHAPTERS):; mkdir "$@"
endif

ifeq (,$(findstring k,$(MAKEFLAGS)))
EXIT = || exit 1
else
EXIT = 
endif

capture check ::
	set -x ; for d in $(CHAPTERS) ; do $(MAKE) -C $$d -I .. $@ $(EXIT) ; done

changes:
	-for i in $(CHAPTERS); \
	do diff -u @srcdir@/$$i/chapter.m2 @srcdir@/$$i/test.m2 ;\
	   diff -u @srcdir@/$$i/chapter.out.expected @srcdir@/$$i/test.out.expected ;\
	done

clean::
	rm -f */*.trim */*.out programming/foo */*.tmp

Makefile: Makefile.in; cd ../../..; ./config.status Macaulay2/packages/ComputationsBook/Makefile
distclean::clean
distclean::; rm -f Makefile

# Local Variables:
# compile-command: "make -C $M2BUILDDIR/Macaulay2/packages/ComputationsBook "
# End:
