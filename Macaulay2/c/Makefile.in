# @configure_input@
############################## main target
all:: scc1
include ../../include/config.Makefile
top_srcdir = @top_srcdir@
VPATH = @srcdir@
############################################
%.c        : %.y
	$(YACC) $(YFLAGS) $^
	mv y.tab.c $*.c
	rm -f y.tab.h y.output
############################################################
.PHONY : clean all install
YFLAGS := -vdlt
LOADLIBES += -lm -lgc
CNAMES := scc1.c readfile.c error.c dictionary.c list.c cprint.c type.c chk.c compat.c
HFILES := $(CNAMES:.c=.h) scc.h grammar.h
OFILES := $(CNAMES:.c=.o) grammar.o
SRCFILES := $(HFILES) $(CNAMES) grammar.y
CPPFLAGS += -I../../include
CPPFLAGS += -I@srcdir@
############################## compiling
scc1 : $(OFILES)
	$(LINK.o) $^ $(LOADLIBES) $(LDLIBS) $(OUTPUT_OPTION)
$(OFILES) : $(HFILES)
grammar.o : grammar.c; $(CC) $(CPPFLAGS) -c $< $(OUTPUT_OPTION)
############################## miscellaneous
TAGS: $(SRCFILES); etags $^
############################## cleaning
# we purposely don't delete grammar.c so it can be used for porting
clean :
	rm -f *.o scc1 scc.a grammar.output grammar.tab.h \
		scc.install TAGS scc core y.tab.h y.output
distclean : clean
	rm -f Makefile

Makefile : Makefile.in
	cd ../..; ./config.status Macaulay2/c/Makefile
