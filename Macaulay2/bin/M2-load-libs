#! /bin/sh

if ! type -p M2 >/dev/null
then echo 'M2 not found on path' >&2
     exit 1
fi

NEWLIB="$(dirname $(dirname $(type -p M2)))/lib"

if ! [ -d "$NEWLIB" ]
then echo "directory $NEWLIB not found" >&2
     exit 1
fi

if [ -f /etc/ld.so.conf ]
then OLIBS=`cat /etc/ld.so.conf | xargs echo | sed 's/ /:/g'`
fi

export LD_LIBRARY_PATH="/usr/lib:/lib:/usr/local/lib:$OLIBS:$NEWLIB" 
exec M2 "$@"
